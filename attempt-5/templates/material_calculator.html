<!DOCTYPE html>
<html>
<head>
    <title>Material Calculator</title>
    <link href="/static/css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>Material Calculator</h1>
        <div class="calculator">
            <h2>Calculate Materials Needed</h2>
            <form method="post">
                <div class="form-group">
                    <label for="diameter">Diameter ({{ 'mm' if units == 'metric' else 'in' }}):</label>
                    <input type="number" id="diameter" name="diameter" value="50" onchange="calculateMaterials()">
                </div>
                <div class="form-group">
                    <label for="length">Length ({{ 'mm' if units == 'metric' else 'in' }}):</label>
                    <input type="number" id="length" name="length" value="10000" onchange="calculateMaterials()">
                </div>
                <div class="form-group">
                    <label for="material">Material:</label>
                    <select id="material" name="material" onchange="calculateMaterials()">
                        <option value="ripstop">Ripstop Nylon ($15/m²)</option>
                        <option value="polyester">Polyester ($12/m²)</option>
                        <option value="cotton">Cotton ($8/m²)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="seam_allowance">Seam Allowance ({{ 'mm' if units == 'metric' else 'in' }}):</label>
                    <input type="number" id="seam_allowance" name="seam_allowance" value="10" onchange="calculateMaterials()">
                </div>
                <button type="submit">Calculate</button>
            </form>
        </div>
        {% if result %}
        <div class="result">
            <h3>Pattern Dimensions</h3>
            <p><strong>Circumference:</strong> {{ result.circumference|round(1) }} {{ 'mm' if units == 'metric' else 'in' }}</p>
            <p><strong>Pattern Width:</strong> {{ result.pattern_width|round(1) }} {{ 'mm' if units == 'metric' else 'in' }}</p>
            <p><strong>Pattern Height:</strong> {{ result.pattern_height|round(1) }} {{ 'mm' if units == 'metric' else 'in' }}</p>
            <p><strong>Total Area:</strong> {{ result.total_area|round(4) }} m²</p>
        </div>
        <div class="material-list">
            <h3>Shopping List</h3>
            <ul>
                {% for item in result.shopping_list %}
                <li>{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        <div class="cost-estimator">
            <h3>Cost Estimation</h3>
            <p><strong>Material Cost:</strong> ${{ result.material_cost|round(2) }}</p>
            <p><strong>Additional Supplies:</strong> ${{ result.additional_supplies|round(2) }}</p>
            <p><strong>Total Estimated Cost:</strong> ${{ result.total_cost|round(2) }}</p>
        </div>
        {% endif %}
    </div>
    <script>
        function calculateMaterials() {
            const diameter = parseFloat(document.getElementById('diameter').value);
            const length = parseFloat(document.getElementById('length').value);
            const seam_allowance = parseFloat(document.getElementById('seam_allowance').value);
            const material = document.getElementById('material').value;
            const circumference = Math.PI * diameter;
            const pattern_width = circumference + (2 * seam_allowance);
            const pattern_height = length + (2 * seam_allowance);
            const total_area = (pattern_width * pattern_height) / 1000000;
            const prices = {'ripstop': 15, 'polyester': 12, 'cotton': 8};
            const material_cost = total_area * prices[material];
            const additional_supplies = 5;
            const total_cost = material_cost + additional_supplies;
            document.getElementById('circumference').textContent = circumference.toFixed(1);
            document.getElementById('pattern_width').textContent = pattern_width.toFixed(1);
            document.getElementById('pattern_height').textContent = pattern_height.toFixed(1);
            document.getElementById('total_area').textContent = total_area.toFixed(4);
            const shopping_list = document.getElementById('shopping_list');
            shopping_list.innerHTML = `
                <li>${total_area.toFixed(2)}m² of ${material}</li>
                <li>2 carabiners</li>
                <li>Matching thread</li>
                <li>Sewing needles</li>
            `;
            document.getElementById('material_cost').textContent = material_cost.toFixed(2);
            document.getElementById('additional_supplies').textContent = additional_supplies.toFixed(2);
            document.getElementById('total_cost').textContent = total_cost.toFixed(2);
            document.getElementById('results').style.display = 'block';
        }
    </script>
</body>
</html>
